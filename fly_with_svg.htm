<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>GreenLift AI ‚Äì Drone Map Simulation</title>
    <style>
        body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            background: #f5f5f5;
        }
        #map-container {
            width: 100vw;
            height: 100vh;
            position: relative;
        }
        #map {
            width: 100%;
            height: 100%;
            border: none;
        }
        #controls {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.95);
            padding: 12px 20px;
            border-radius: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: flex;
            gap: 15px;
            z-index: 10;
        }
        #back-btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            text-decoration: none;
            cursor: pointer;
        }
        #back-btn:hover {
            background: #2563eb;
        }
        #status {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 14px;
        }
        #drone-icon {
            position: absolute;
            width: 32px;
            height: 32px;
            z-index: 6;
            pointer-events: none;
            filter: drop-shadow(0 1px 2px rgba(0,0,0,0.3));
        }
    </style>
</head>
<body>
    <div id="map-container">
        <iframe
            id="map"
            src="https://www.openstreetmap.org/export/embed.html?bbox=89.225,23.995,89.245,24.015&layer=mapnik"
            frameborder="0">
        </iframe>

        <!-- Start marker -->
        <div style="position:absolute; left:30%; top:60%; transform:translate(-50%,-50%); z-index:5; font-size:24px;">üöÅ</div>
        <!-- Destination marker -->
        <div style="position:absolute; left:60%; top:40%; transform:translate(-50%,-50%); z-index:5; font-size:20px;">üìç</div>
        <!-- Route line -->
        <div style="position:absolute; left:30%; top:60%; width:calc(30% - 2px); height:2px; background:#3b82f6; transform:translateY(-50%) rotate(-35deg); transform-origin:left center; z-index:4;"></div>

        <!-- Animated drone (SVG) -->
        <img id="drone-icon" src="greenlift-drone-3d.svg" alt="Drone" style="display:none;">

        <div id="controls">
            <a href="index.html" id="back-btn">‚¨ÖÔ∏è Back to Order</a>
            <button id="start-flight">‚ñ∂Ô∏è Start Drone Flight</button>
        </div>
        <div id="status">Drone ready at Pabna University</div>
    </div>

    <script>
        const droneIcon = document.getElementById('drone-icon');
        let animationId = null;

        document.getElementById('start-flight').addEventListener('click', () => {
            // Show drone
            droneIcon.style.display = 'block';
            droneIcon.style.left = '30%';
            droneIcon.style.top = '60%';

            // Reset any ongoing animation
            if (animationId) cancelAnimationFrame(animationId);

            let progress = 0;
            const startX = 30, startY = 60;
            const endX = 60, endY = 40;

            document.getElementById('status').textContent = "Drone taking off...";

            function animate() {
                progress += 0.01;
                if (progress > 1) {
                    document.getElementById('status').textContent = "‚úÖ Package delivered!";
                    return;
                }

                const x = startX + (endX - startX) * progress;
                const y = startY + (endY - startY) * progress;

                droneIcon.style.left = `${x}%`;
                droneIcon.style.top = `${y}%`;

                // Slight forward tilt during flight
                const angle = -35 + (progress < 0.1 ? -10 * (1 - progress * 10) : 0);
                droneIcon.style.transform = `rotate(${angle}deg)`;

                if (progress < 0.3) {
                    document.getElementById('status').textContent = "Ascending & transitioning...";
                } else if (progress < 0.8) {
                    document.getElementById('status').textContent = "En route to destination...";
                } else {
                    document.getElementById('status').textContent = "Descending to deliver...";
                }

                animationId = requestAnimationFrame(animate);
            }

            animate();
        });
    </script>
</body>
</html>
