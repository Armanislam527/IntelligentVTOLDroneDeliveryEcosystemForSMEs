<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>GreenLift AI ‚Äì Drone Map Simulation</title>
    <style>
        body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            background: #f5f5f5;
        }
        #map-container {
            width: 100vw;
            height: 100vh;
            position: relative;
        }
        #map {
            width: 100%;
            height: 100%;
            border: none;
        }
        #controls {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.95);
            padding: 12px 20px;
            border-radius: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: flex;
            gap: 15px;
            z-index: 10;
        }
        #back-btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            cursor: pointer;
            text-decoration: none;
        }
        #back-btn:hover {
            background: #2563eb;
        }
        #status {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div id="map-container">
        <iframe
            id="map"
            src="https://www.openstreetmap.org/export/embed.html?bbox=89.225,23.995,89.245,24.015&layer=mapnik"
            frameborder="0">
        </iframe>
        <div id="controls">
            <a href="index.html" id="back-btn">‚¨ÖÔ∏è Back to Order</a>
            <button id="start-flight">‚ñ∂Ô∏è Start Drone Flight</button>
        </div>
        <div id="status">Drone ready at Pabna University</div>
    </div>

    <script>
        // Coordinates (approximate, in map pixel space)
        // We'll simulate movement by animating an overlay on top of the iframe
        // Since we can't draw directly on iframe, we use an absolute-positioned div

        // Create overlay container
        const overlay = document.createElement('div');
        overlay.style.position = 'absolute';
        overlay.style.top = '0';
        overlay.style.left = '0';
        overlay.style.width = '100%';
        overlay.style.height = '100%';
        overlay.style.pointerEvents = 'none';
        overlay.style.zIndex = '5';
        document.getElementById('map-container').appendChild(overlay);

        // Add start and end markers + route
        function drawMapElements() {
            // Clear previous
            overlay.innerHTML = '';

            // Start: Pabna University (~center-left)
            const start = document.createElement('div');
            start.innerHTML = 'üöÅ';
            start.style.position = 'absolute';
            start.style.left = '30%';
            start.style.top = '60%';
            start.style.fontSize = '24px';
            start.style.transform = 'translate(-50%, -50%)';
            start.title = 'Pabna University (Start)';
            overlay.appendChild(start);

            // End: ~1km southeast (e.g., Pabna town center)
            const end = document.createElement('div');
            end.innerHTML = 'üìç';
            end.style.position = 'absolute';
            end.style.left = '60%';
            end.style.top = '40%';
            end.style.fontSize = '20px';
            end.style.transform = 'translate(-50%, -50%)';
            end.title = 'Delivery Point (Destination)';
            overlay.appendChild(end);

            // Route line
            const route = document.createElement('div');
            route.style.position = 'absolute';
            route.style.left = '30%';
            route.style.top = '60%';
            route.style.width = 'calc(30% - 2px)';
            route.style.height = '2px';
            route.style.backgroundColor = '#3b82f6';
            route.style.transform = 'translateY(-50%) rotate(-35deg)';
            route.style.transformOrigin = 'left center';
            overlay.appendChild(route);
        }

        drawMapElements();

        // Drone icon
        let droneIcon = null;
        let animationId = null;

        document.getElementById('start-flight').addEventListener('click', () => {
            // Remove previous drone
            if (droneIcon) droneIcon.remove();
            if (animationId) cancelAnimationFrame(animationId);

            // Create drone
            droneIcon = document.createElement('div');
            droneIcon.innerHTML = 'üöÅ';
            droneIcon.style.position = 'absolute';
            droneIcon.style.fontSize = '24px';
            droneIcon.style.transform = 'translate(-50%, -50%)';
            droneIcon.style.zIndex = '6';
            droneIcon.style.pointerEvents = 'none';
            overlay.appendChild(droneIcon);

            // Start position (%)
            let progress = 0;
            const startX = 30, startY = 60;
            const endX = 60, endY = 40;

            document.getElementById('status').textContent = "Drone taking off...";

            function animate() {
                progress += 0.01;
                if (progress > 1) {
                    document.getElementById('status').textContent = "‚úÖ Package delivered!";
                    return;
                }

                const x = startX + (endX - startX) * progress;
                const y = startY + (endY - startY) * progress;

                droneIcon.style.left = `${x}%`;
                droneIcon.style.top = `${y}%`;

                // Rotate drone slightly forward during flight
                const angle = -35 + (progress < 0.1 ? -10 * (1 - progress * 10) : 0);
                droneIcon.style.transform = `translate(-50%, -50%) rotate(${angle}deg)`;

                if (progress < 0.3) {
                    document.getElementById('status').textContent = "Ascending & transitioning...";
                } else if (progress < 0.8) {
                    document.getElementById('status').textContent = "En route to destination...";
                } else {
                    document.getElementById('status').textContent = "Descending to deliver...";
                }

                animationId = requestAnimationFrame(animate);
            }

            animate();
        });
    </script>
</body>
</html>
